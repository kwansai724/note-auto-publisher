# トラブルシューティング

## よくあるエラーと対処法

### ログイン失敗

**症状**: `ログイン中...` のあと `TimeoutError` でエラー終了

**原因と対処**:
1. **メールアドレスまたはパスワードが間違っている**
   - GitHub Secretsの `NOTE_EMAIL` と `NOTE_PASSWORD` を再確認
   - noteにブラウザから手動ログインできるか確認

2. **2段階認証が有効**
   - noteの設定 → アカウント設定 → 2段階認証を無効にする
   - エラーメッセージに「2段階認証」と表示されている場合はこれが原因

3. **noteのログイン画面が変更された**
   - noteのUIアップデートによりセレクタが機能しなくなった可能性
   - 手動でnoteにログインして、ログイン画面の構造を確認

### 下書きが見つからない

**症状**: `公開対象の下書きが見つかりません` と表示される

**対処**:
1. 下書きのタイトルに `[01]`、`[02]` などのプレフィックスが付いているか確認
2. プレフィックスは半角角括弧 `[]` と半角数字を使う
3. プレフィックスのあとに半角スペースを入れる: `[01] タイトル`

### 「公開」ボタンが見つからない

**症状**: `「公開」ボタンが見つかりません` でエラー終了

**原因**: noteのUI変更により、ボタンのテキストやDOM構造が変わった可能性があります。

**対処**:
1. エラー時のスクリーンショットをGitHub ActionsのArtifactsからダウンロードして確認
2. noteの記事編集ページを手動で開き、公開ボタンの現在のテキストを確認
3. `src/publish.ts` のセレクタを修正

### GitHub Actionsが実行されない

**対処**:
1. リポジトリのActionsが有効になっているか確認（Settings → Actions → General）
2. ワークフローファイルがデフォルトブランチ（main）にあるか確認
3. GitHub Actionsのcronは数分〜数十分の遅延が発生することがあります（正常）

### タイムアウトエラー

**症状**: 10分のタイムアウトでジョブが失敗

**対処**:
1. noteのサーバーが一時的に遅い場合があります。再実行してみてください
2. 繰り返し発生する場合は、ネットワークの問題やnoteのメンテナンス中の可能性

## エラースクリーンショットの確認方法

エラー発生時、スクリーンショットがGitHub ActionsのArtifactsに保存されます。

1. Actions → 失敗したワークフロー実行をクリック
2. ページ下部の「Artifacts」セクションから `error-screenshots` をダウンロード
3. スクリーンショットでエラー時のページ状態を確認

> ログイン画面のスクリーンショットはセキュリティのため保存されません。

## 手動実行でのデバッグ

ローカルで `HEADLESS=false` に設定すると、ブラウザの動作を目視確認できます：

```bash
HEADLESS=false npm run dry-run
```

## サポート

問題が解決しない場合：
1. GitHub Issuesで報告してください
2. エラーメッセージとActionsのログを添付してください
3. スクリーンショット（Artifacts）があれば添付してください
